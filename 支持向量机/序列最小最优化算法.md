# 序列最小最优化算法

## 支持向量机的低效问题

支持向量机的拉格朗日乘数法对偶形式的外部最大化问题可以转变为以下的一般形式：
$$
\begin{aligned}
& \min_a\frac12\sum_{i=1}^N\sum_{j=1}^Na_ia_jy_iy_jK(x_i,x_j)-\sum_{i=1}^Na_i \\
&s.t. \quad \sum_{i=1}^Na_iy_i=0 \\
& 0 \leq a_i \leq C,i=1,2,...,N
\end{aligned}
s.t.
$$


其中一个变量$α_i$对应一个样本点$(x_i,y_i)$，变量总数等于训练样本容量$N$。于是，当训练样本容量很大时，求解每个变量将变得非常低效，为了解决低效问题，提出了序列最小最优化算法以快速计算，实现支持向量机。



## 序列最小最优化算法（SMO）的思路

SMO算法认为，因为KKT条件是该最优化问题的充分必要条件，如果所有变量的解都满足此最优化问题的KKT条件，那么这个最优化问题的解就得到了。

我们可以不用一次性得到所有变量的最优解，而是先选择两个变量，暂时将其它变量作为常数看待，这时两个变量的最优化问题（子问题）可以通过解析方法求解（可以得到具体的值），这样就可以大大提高整个算法的计算速度。

子问题有两个变量，一个是违反KKT条件最严重的那一个，另一个由约束条件自动确定。如此，SMO算法将原问题不断分解为子问题并对子问题求解，进而达到求解原问题的目的。

但是为什么是需要两个变量，而不是直接一个呢？我们可以看一下如果只选择一个变量进行优化，将其它变量都作为常数会发生什么。

根据等式约束条件我们可以得到：
$$
\sum_{i=1}^Na_iy_i=0 \rightarrow a_1y_1+\sum_{i=2}^Na_iy_i=0 \rightarrow a_i=-\frac{\sum_{i=2}^Na_iy_i}{y_1}
$$
这样事实上就直接得到了$a_1$的值，并不能再对其进行优化了，因此我们选择两个变量进行优化。

假设$a_1,a_2$为两个变量，$a_3,a_4, \cdots , a_N$固定，那么由等式约束条件可知：
$$
\sum_{i=1}^Na_iy_i=0 \rightarrow a_1y_1+a_2y_2+\sum_{i=3}^Na_iy_i=0 \rightarrow a_1y_1+a_2y_2=-\sum_{i=3}^Na_iy_i
$$
如果$a_2$确定，那么$a_1$也随之确定，所以子问题的两个变量中只有一个是自由变量，两个变量将同时更新。

整个SMO算法包括两个部分：第一，是求解两个变量二次规划的解析方法，但是最开始怎么决定选择哪两个变量呢？这时候就要用到第二个部分，即选择变量的启发式方法。

首先我们假定已经选择了两个变量，看看如何对这两个变量进行优化。

## 两个变量二次规划的求解方法

在选择变量$a_1$和$a_2$的情况下，最初的最优化问题的子问题可以写成：