# 支持向量机

支持向量机，可以看着是升级版的感知机，与感知机相比。他们都是找到一个超平面对数据集进行分割，区别在于，感知机模型得到的超平面空间中可以有无穷个超平面，但支持向量机仅含有一个，这一个超平面与样本点的间隔是最大化的。

支持向量机学习方法包含三种模型：

* 线性可分支持向量机，要求训练集线性可分，通过硬间隔最大化得到超平面。
* 线性支持向量机，要求训练集近似线性可分，通过软间隔最大化获得超平面
* 非线性支持向量机，训练集线性不可分，可通过使用核函数将线性不可分的训练集转换为线性可分的数据集，并通过软间隔最大化获得超平面。

# 线性可分支持向量机

对于线性可分的数据集，学习的目标是在特征空间中找到一个分离超平面，能将实例分到不同的类。分离超平面将特征空间划分为两部分，一部分是正类，一部分是负类。分离超平面的法向量指向的一侧为正类，另一侧为负类。

并且要求这个分离超平面距离最近的两个点的距离之和最大，这个分离超平面被称为间隔最大分离超平面。

线性可分支持向量机的数学模型为：
$$
f(x)=sign(w^**x+b^*)
$$



其中$w^**x+b^* = 0$就是间隔最大分离超平面。

我们所需要求得的模型就是这个间隔最大的分离超平面。



## 函数间隔和几何间隔

### 函数间隔

一般来说，一个点距离分离超平面的远近可以表示分类预测的确信程度。在超平面$w*x+b=0$确定的情况下，$|w*x+b|$能够相对地表示点x距离超平面的远近。而$w*x+b$的符号与类标记$y$的符号是否一致能够表示分类是否正确。因为在二分类问题中，$y$要么为1，要么为-1，所以可用$y(w*x+b)$来表示分类的正确性及确信度，这就是函数间隔的概念。

定义超平面关于样本点$(x_i,y_i)$的函数间隔为：
$$
\hat{\gamma}_i=y_i(w \cdot x_i+b)
$$
定义超平面$(w,b)$关于训练数据集$T$的函数间隔为超平面$(w,b)$关于$T$中所有样本点$(x_i,y_i)$的函数间隔的最小值：
$$
\hat{\gamma} = \min_{i=1,...,N}\hat{\gamma}_i
$$
但是选择分离超平面时，只有函数间隔还不够。因为只要成比例改变$w$和$b$超平面并没有改变，函数间隔却改变了。

### 几何间隔

因为函数间隔无法确定$w$和$b$，所以可以对$w$施加约束，如规范化$||w||=1$，这样函数间隔就成为几何间隔。

定义超平面关于样本点$(x_i,y_i)$的几何间隔为：
$$
\gamma_i=\quad y_i\left( \frac{w}{||w||} \cdot x_i+\frac{b}{||w||} \right)
$$


定义超平面（w,b）关于训练数据集T的几何间隔为超平面（w,b）关于T中所有样本点（xi,yi）的几何间隔的最小值：
$$
\gamma=\min_{i=1,...,N}\gamma_i
$$


几何间隔与函数间隔的关系：
$$
\gamma=\frac{\hat{\gamma}}{||w||}
$$


## 最大间隔法

求一个最大间隔分离超平面，可以用约束最优化问题的形式来表示：
$$
\begin{aligned}
& \max_{w,b}\gamma	\\
&s.t. \quad y_i\left( \frac{w}{||w||} \cdot x_i+\frac{b}{||w||} \right)\geq \gamma,\quad i=1,2,...,N
\end{aligned}
$$
我们可以通过几何间隔和函数间隔的关系代入上面的公式：
$$
\begin{aligned}
& \max_{w,b}\frac{\hat{\gamma}}{||w||} \\
&s.t.\quad y_i\left( w \cdot  x_i+b \right)\geq \hat{\gamma},\quad i=1,2,...,N
\end{aligned}
$$
因为函数间隔对w和b按比例改变，函数间隔也按此比例改变的特性，w和b的改变并不会影响上式中的目标函数的优化和约束条件，因此，我们可以对函数间隔随意取值，为了方便，我们取$\hat{\gamma}=1$

另外，我们可以将最大化问题转换为最小化问题，即将 $\max \frac{1}{||w||}$转换为 $\min ||w||$，这样得到的问题为：
$$
\begin{aligned}
& \min_{w,b}||w|| \\
&s.t.\quad y_i\left( w \cdot  x_i+b \right)-1\geq 0,\quad i=1,2,...,N
\end{aligned}
$$
可以使用拉格朗日乘数法求解。

同时为了之后的计算方便，我们可以将问题转变为：
$$
\begin{aligned}
& \min_{w,b}\frac12||w||^2 \\
&s.t.\quad y_i\left( w \cdot  x_i+b \right)-1\geq 0,\quad i=1,2,...,N
\end{aligned}
$$
因为$||w||\geq 0$，因此平方后再乘以一个系数不会对最小化问题产生影响。

上述的问题是一个凸二次规划问题。

现在，我们只需解答上述问题，得到最优特征向量$w^*$和最优偏置$b^*$，就可以得到最大间隔分离超平面和决策函数。问题在于如何求解该问题。



## 对偶算法